<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=IM+Fell+English:ital@0;1&family=MedievalSharp&display=swap" rel="stylesheet">
    <title>Gestor de Baluartes</title>
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .stronghold-section {
            background: #f8f9fa;
            border: 2px solid #2c3e50;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .stronghold-section h3 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        .room-card, .staff-card, .event-card {
            background: white;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 10px;
        }
        .room-card h4, .staff-card h4, .event-card h4 {
            margin-top: 0;
            color: #2980b9;
        }
        .cost-badge {
            display: inline-block;
            background: #f39c12;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
            margin-right: 10px;
        }
        .time-badge {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
        }
        .severity-minor { background: #2ecc71; }
        .severity-moderate { background: #f39c12; }
        .severity-severe { background: #e74c3c; }
        .severity-critical { background: #c0392b; }
        .action-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .tab-btn {
            flex: 1;
            padding: 10px;
            border: 2px solid #2c3e50;
            background: white;
            cursor: pointer;
            font-weight: bold;
            border-radius: 4px;
            transition: all 0.3s;
        }
        .tab-btn.active {
            background: #2c3e50;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .construction-item {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 8px;
            border-left: 4px solid #f39c12;
        }
        .construction-complete {
            border-left-color: #27ae60;
        }
        .btn-build {
            background: #27ae60;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin-top: 10px;
            width: 100%;
        }
        .btn-build:hover {
            background: #229954;
        }
        .btn-build:disabled {
            background: #95a5a6;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <header>
        <div class="brand">ğŸ° Gestor de Baluartes</div>
        <a href="../index.html" class="back-btn">â¬… Volver al MenÃº</a>
    </header>

    <div class="generator-layout">
        <div class="panel">
            <h2>Construir Baluarte</h2>

            <!-- NUEVA SECCIÃ“N: BALUARTES GUARDADOS -->
            <div style="margin-bottom: 20px;">
                <button class="btn-generate" id="btnShowList" style="background:#34495e; width:100%;">
                    ğŸ“š Mis Baluartes Guardados
                </button>
                <div id="strongholdList" style="display:none; margin-top:10px; max-height:200px; overflow-y:auto; border:1px solid #ddd; padding:10px; border-radius:4px; background:#f8f9fa;">
                    <!-- Lista dinÃ¡mica -->
                </div>
            </div>

            <div class="action-tabs">
                <button class="tab-btn active" onclick="switchTab('stronghold')">ğŸ° Baluarte</button>
                <button class="tab-btn" onclick="switchTab('hireling')">ğŸ‘¤ Empleado</button>
                <button class="tab-btn" onclick="switchTab('event')">âš ï¸ Evento</button>
            </div>

            <!-- TAB: GENERAR BALUARTE -->
            <div id="tab-stronghold" class="tab-content active">
                <label>Tipo de Baluarte</label>
                <select id="strongholdType">
                    <option value="Castle">ğŸ° Castillo</option>
                    <option value="Wizard Tower">ğŸ”® Torre de Mago</option>
                    <option value="Guild Hall">ğŸ›¡ï¸ Sede de Gremio</option>
                    <option value="Temple">â›ª Templo</option>
                    <option value="Fortress">ğŸ—¿ Fortaleza</option>
                    <option value="Manor">ğŸ›ï¸ MansiÃ³n</option>
                    <option value="Keep">ğŸ¯ Fortaleza</option>
                </select>

                <label>Nombre (Opcional)</label>
                <input type="text" id="strongholdName" placeholder="Ej: La Torre de Obsidiana...">

                <label>Nivel del Personaje (5-20)</label>
                <input type="number" id="level" min="5" max="20" value="5">

                <label>DescripciÃ³n de UbicaciÃ³n (Opcional)</label>
                <textarea id="locationDescription" placeholder="Ej: En lo alto de una colina rocosa cerca de un bosque encantado..." rows="2"></textarea>

                <button class="btn-generate" id="btnGenStronghold" style="background:#8e44ad;">
                    ğŸ—ï¸ Fundar Baluarte
                </button>
            </div>

            <!-- TAB: GENERAR EMPLEADO -->
            <div id="tab-hireling" class="tab-content">
                <label>Puesto de Trabajo</label>
                <input type="text" id="hirelingRole" placeholder="Ej: Cocinero, Guardia, Bibliotecario...">

                <label>Tipo de Baluarte</label>
                <select id="hirelingStrongholdType">
                    <option value="Castle">ğŸ° Castillo</option>
                    <option value="Wizard Tower">ğŸ”® Torre de Mago</option>
                    <option value="Guild Hall">ğŸ›¡ï¸ Sede de Gremio</option>
                    <option value="Temple">â›ª Templo</option>
                    <option value="Fortress">ğŸ—¿ Fortaleza</option>
                </select>

                <button class="btn-generate" id="btnGenHireling" style="background:#16a085;">
                    ğŸ‘¤ Generar Empleado
                </button>
            </div>

            <!-- TAB: GENERAR EVENTO -->
            <div id="tab-event" class="tab-content">
                <label>Tipo de Baluarte</label>
                <select id="eventStrongholdType">
                    <option value="Castle">ğŸ° Castillo</option>
                    <option value="Wizard Tower">ğŸ”® Torre de Mago</option>
                    <option value="Guild Hall">ğŸ›¡ï¸ Sede de Gremio</option>
                    <option value="Temple">â›ª Templo</option>
                    <option value="Fortress">ğŸ—¿ Fortaleza</option>
                </select>

                <label>Severidad</label>
                <select id="eventSeverity">
                    <option value="Minor">ğŸŸ¢ Menor</option>
                    <option value="Moderate">ğŸŸ¡ Moderado</option>
                    <option value="Severe">ğŸŸ  Severo</option>
                    <option value="Critical">ğŸ”´ CrÃ­tico</option>
                </select>

                <button class="btn-generate" id="btnGenEvent" style="background:#e74c3c;">
                    âš ï¸ Generar Evento
                </button>
            </div>

            <hr>
            <button class="btn-generate" id="btnSave" style="display:none; background:#27ae60;">ğŸ’¾ Guardar Cambios</button>
            <button class="btn-export" id="btnExp" style="display:none;">Exportar a Journal</button>
            <button class="btn-generate" id="btnDelete" style="display:none; background:#c0392b;">ğŸ—‘ï¸ Eliminar Baluarte</button>
        </div>

        <div class="panel result-panel">
            <!-- PANEL DE GESTIÃ“N TEMPORAL Y BP -->
            <div id="timeManagement" style="display:none; background:#2c3e50; color:white; padding:15px; border-radius:8px; margin-bottom:20px;">
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:15px;">
                    <!-- Columna Izquierda: Tiempo -->
                    <div>
                        <h3 style="margin:0; font-size:1.5em;">ğŸ“… DÃ­a <span id="currentDay">0</span></h3>
                        <p style="margin:5px 0 0 0; font-size:0.9em; opacity:0.8;">GestiÃ³n Temporal</p>
                        <div style="display:flex; gap:8px; margin-top:10px;">
                            <button onclick="advanceDay(1)" style="background:#27ae60; color:white; border:none; padding:8px 15px; border-radius:4px; cursor:pointer; font-weight:bold; flex:1;">+1</button>
                            <button onclick="advanceDay(7)" style="background:#2980b9; color:white; border:none; padding:8px 15px; border-radius:4px; cursor:pointer; font-weight:bold; flex:1;">+7</button>
                            <button onclick="advanceDay(30)" style="background:#8e44ad; color:white; border:none; padding:8px 15px; border-radius:4px; cursor:pointer; font-weight:bold; flex:1;">+30</button>
                        </div>
                    </div>
                    
                    <!-- Columna Derecha: Puntos de BastiÃ³n -->
                    <div>
                        <h3 style="margin:0; font-size:1.5em;">â­ <span id="bastionPoints">0</span> BP</h3>
                        <p style="margin:5px 0 0 0; font-size:0.9em; opacity:0.8;">Puntos de BastiÃ³n</p>
                        <button onclick="executeBastionTurn()" id="btnBastionTurn" style="background:#f39c12; color:white; border:none; padding:10px; border-radius:4px; cursor:pointer; font-weight:bold; width:100%; margin-top:10px;">
                            ğŸ² Turno de BastiÃ³n (cada 7 dÃ­as)
                        </button>
                        <p id="bastionTurnInfo" style="margin:5px 0 0 0; font-size:0.8em; opacity:0.7; text-align:center;">Ãšltimo: DÃ­a <span id="lastBastionTurn">0</span></p>
                    </div>
                </div>
                
                <!-- Panel de Construcciones -->
                <div id="constructionProgress" style="padding-top:15px; border-top:1px solid rgba(255,255,255,0.2);">
                    <!-- Construcciones en progreso -->
                </div>
                
                <!-- Panel de Instalaciones Disponibles -->
                <div id="facilitiesPanel" style="margin-top:15px; padding-top:15px; border-top:1px solid rgba(255,255,255,0.2); display:none;">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                        <h4 style="margin:0;">ğŸ—ï¸ Instalaciones Disponibles</h4>
                        <button onclick="toggleFacilitiesPanel()" style="background:rgba(255,255,255,0.1); color:white; border:1px solid rgba(255,255,255,0.3); padding:5px 15px; border-radius:4px; cursor:pointer;">
                            Cerrar
                        </button>
                    </div>
                    <div id="facilitiesList" style="max-height:400px; overflow-y:auto;">
                        <!-- Lista de instalaciones -->
                    </div>
                </div>
            </div>

            <div id="loader" class="loader">ğŸ—ï¸ Construyendo...</div>
            <div id="resultContent">
                <p style="text-align:center; margin-top:150px; color:#aaa;">Selecciona quÃ© generar...</p>
            </div>
        </div>
    </div>

    <script src="../js/stronghold.js"></script>
</body>
</html>
